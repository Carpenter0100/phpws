<!DOCTYPE html>
<html>
<head>
    <title>Protocol stacking</title>
    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script src="../js/phpws.js"></script>
</head>
<body>

<h1>JsonTransport</h1>
<pre id="log"></pre>

<script>
    var log = document.getElementById("log");


    var socket = new Phpws.Client("ws://localhost:12345/stack");
    socket.open().then(function(){
        log.innerText += "Connected\n";
    });

    socket.on("close", function(){
        log.innerText += "Closed\n";
    });

    var jsonTransport = new Phpws.JsonTransport(socket);

    jsonTransport.on("message", function(jsonMessage){
        log.innerText += "Got message '" + jsonMessage.getData() + "'. Will send reply now before closing!\n";
        jsonMessage.reply("Hello to you too!");
        socket.close();
    });



</script>
</body>
</html>